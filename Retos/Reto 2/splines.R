#Reto 2 - Analisis Numerico
#Sofia Coral
#John Gonzalez
#Stiven Gonzalez
#Daniel Tibaquira

library(rgl)

cantPuntosSpline = 201

#Calcula el error para cada nivel
calcularError = function(x, y, z, xOP, yOP){
  errores = c()
  errores2 = c()
  funcion = splinefun(x,y)
  cat("\n\nAltura : ", z)
  cat("\n----------------------------------------------------------------------------------------\n")
  cat("# dato\tX Evaluado\tY Obtenido\tY Real\t\tError Relativo\tError Absoulto")
  cat("\n----------------------------------------------------------------------------------------\n")
  for( i in 1:length(xOP)){
    ySpl = funcion( xOP[i] )
    errorAct = abs((ySpl - yOP[i])/yOP[i])
    errorAct = errorAct * 100
    errores = c(errores, errorAct)
    errorAbs = abs((ySpl - yOP[i]))
    errores2 = c( errores2, errorAbs )
    cat( i, "\t", xOP[i], "\t", ySpl, "\t", yOP[i],"\t", errorAct,"\t", errorAbs ,"\n")
  }
  
  errorProm = sum(errores) / length(errores)
  errorProm2 = sum(errores2) / length(errores2)
  cat("----------------------------------------------------------------------------------------\n")
  cat("ERROR RELATIVO PROMEDIO : ", errorProm, "\n")
  cat("ERROR ABSOLUTO PROMEDIO : ", errorProm2, "\n")
  return (errores)
}

#dibuja la función resultado de la interpolación
pintarCurva = function(x, y, z){
  res = spline(x, y, n = cantPuntosSpline)
  x1 = res$x
  y1 = res$y
  plot3d(x1,y1,z, type="l", size=4, add=TRUE, xlab="x",ylab="y",zlab="z", col = "blue")
}

#Dibuja los puntos tomados como base
pintarPuntos = function(x, y, z){
  
  p<- matrix(c(z, z, z), ncol=3, nrow=length(x), byrow=TRUE)
  p[,1]<-x
  p[,2]<-y
  xS<-p[,1]
  yS<-p[,2]
  zS<-p[,3]
  plot3d(xS,yS,zS, type="p", size=4, add=TRUE, xlab="x",ylab="y",zlab="z")
  
  pintarCurva(x, y, z)
}


#Crea una linea que une las dos partes de cada nivel (los reflejos)
completarCircunferencia = function(x1, y1, z1, izquierda){
  res = list()
  pos1 = 1
  pos2 = length(x1)
  if (izquierda){
    pos1 = length(x1)
    pos2 = 1
  }
  
  res[[1]] <- c(x1[pos1], x1[pos1]+1e-8)
  res[[2]] <- c(y1[pos1], -y1[pos1])
  pintarPuntos(res[[1]], res[[2]], z1)
}

#Pinta un segmento con sus proyecciones en los 4 cuadrantes
pintarSegmento = function(x, y, xOP, yOP, z, completar=TRUE) {
  if ( completar ){
    completarCircunferencia(x, y, z, TRUE)
    completarCircunferencia(x, y, z, FALSE)
    
  }
  pintarPuntos(x, y, z)
  pintarPuntos(x, -y, z)
  
  calcularError(x, y, z, xOP, yOP)
}

pintarEjes = function(){
  p <- matrix(c(1,1,1), ncol=3, nrow=9, byrow=TRUE)
  xS<-p[,1]
  yS<-p[,2]
  zS<-p[,3]
  plot3d(xS,yS,zS, type="p", size=4, xlab="x",ylab="y",zlab="z")
}


pintarCuerpo = function(){
  m = 1
  # Z = 8.0E-6
  x1   = c(-0.536656,-0.516215,-0.417907,-0.256698,-0.057132,0.047646,0.247212,0.40842,0.506728,0.527169)
  x1OP = c(-0.476118,-0.343818,-0.159896,0.15041,0.334331,0.466632)
  y1   = c(0.039717,0.142482,0.326403,0.458704,0.519241,0.519241,0.458703,0.326403,0.142481,0.039717)
  y1OP = c(0.239284,0.400492,0.4988,0.4988,0.400492,0.239283)
  pintarSegmento(x1, y1, x1OP, y1OP, 8.0E-6)
  
  # Z = 0.020937
  x2   = c(-0.813805,-0.762116,-0.633201,-0.388022,-0.164739,0.155086,0.378369,0.623549,0.752464,0.804153)
  x2OP = c(-0.808761,-0.686369,-0.584431,-0.460219,-0.318506,-0.004826,0.308854,0.450566,0.574778,0.676717,0.799108,-0.782717,-0.721734,-0.52052,-0.240797,-0.084504,0.074851,0.231144,0.510868,0.712082,0.773064)
  y2   = c(0.066777,0.300113,0.501538,0.702173,0.788968,0.788968,0.702173,0.501538,0.300112,0.066776)
  y2OP = c(0.146785,0.441421,0.565279,0.666926,0.742457,0.804673,0.742456,0.666926,0.565278,0.441421,0.146784,0.22262,0.369421,0.613895,0.76298,0.793979,0.793979,0.76298,0.613895,0.36942,0.222619)
  pintarSegmento(x2, y2, x2OP, y2OP, 0.020937)
  
  # Z = 0.167437
  x3   = c(-1.106403,-1.02752,-0.860607,-0.526924,-0.221241,0.210426,0.51611,0.849792,1.016705,1.095587)
  x3OP = c(-1.090477,-0.925285,-0.787699,-0.62005,-0.42878,-0.005407,0.417966,0.609235,0.776884,0.91447,1.079661,-1.064092,-0.981097,-0.707251,-0.326556,-0.113846,0.103031,0.315741,0.696436,0.970282,1.053277)
  y3   = c(0.093932,0.403538,0.677297,0.946509,1.054038,1.054038,0.946509,0.677296,0.403537,0.093932)
  y3OP = c(0.19951,0.591571,0.756383,0.891642,0.992147,1.074936,0.992147,0.891641,0.756383,0.591571,0.19951,0.303043,0.500021,0.828058,1.0281,1.069695,1.069695,1.0281,0.828057,0.500021,0.303043)
  pintarSegmento(x3, y3, x3OP, y3OP, 0.167437)
  
  # Z = 0.523222
  x4   = c(-1.516553,-1.408386,-1.179506,-0.721946,-0.30278,0.289142,0.708308,1.165868,1.394747,1.502914)
  x4OP = c(-0.849644,-0.587367,-0.006819,0.573729,0.836006,1.065893,1.254557,-1.494714,1.481075,-1.268196,-1.079532,-0.969218,-0.447192,-0.155515,0.141877,0.433554,0.95558,1.331089,1.444896,-1.458535,-1.344728)
  y4   = c(0.130677,0.546998,0.915116,1.277121,1.421713,1.421713,1.27712,0.915115,0.546997,0.130676)
  y4OP = c(1.203341,1.338489,1.449814,1.338489,1.203341,1.021462,0.799841,0.272646,0.272644,0.799842,1.021462,1.117841,1.386835,1.442766,1.442766,1.386835,1.117841,0.676736,0.411863,0.411864,0.676737)
  pintarSegmento(x4, y4, x4OP, y4OP, 0.523222)
  
  # Z = 1.004578
  x5   = c(-1.94074,-1.802318,-1.50942,-0.92388,-0.387471,0.370013,0.906421,1.491962,1.784859,1.923281)
  x5OP = c(-1.087295,-0.751658,-0.008729,0.7342,1.069836,1.364025,1.605458,-1.912793,1.895334,-1.622917,-1.381483,-1.240315,-0.572276,-0.199015,0.181557,0.554818,1.222856,1.703396,1.849035,-1.866494,-1.720855)
  y5   = c(0.169695,0.699335,1.167652,1.628191,1.81214,1.81214,1.628191,1.167651,0.699334,0.169694)
  y5OP = c(1.534329,1.706263,1.84789,1.706263,1.534328,1.302943,1.021,0.350306,0.350305,1.021001,1.302944,1.425556,1.767768,1.838924,1.838924,1.767768,1.425556,0.864387,0.527418,0.527419,0.864388)
  pintarSegmento(x5, y5, x5OP, y5OP, 1.004578)
  
  # Z = 1.506862
  x6   = c(-2.239712,-2.080012,-1.742091,-1.066544,-0.447682,0.426238,1.0451,1.720646,2.058567,2.218265)
  x6OP = c(-1.594488,-1.255079,-0.86785,-0.010722,0.846406,1.233635,1.573043,1.851589,-2.207469,2.186023,-1.873034,-1.986027,-2.154052,2.132607,1.964582,1.410175,0.63945,0.208814,-0.230258,-0.660894,-1.43162)
  y6   = c(0.200004,0.817669,1.36382,1.9009,2.11542,2.11542,1.900899,1.363819,0.817668,0.200002)
  y6OP = c(1.521598,1.791438,1.991947,2.157112,1.991947,1.791437,1.521597,1.192795,0.410633,0.410631,1.192796,1.010154,0.617181,0.61718,1.010152,1.664587,2.063674,2.146656,2.146656,2.063674,1.664588)
  pintarSegmento(x6, y6, x6OP, y6OP, 1.506862)
  
  # Z = 2.009147
  x7   = c(-2.338167,-2.171557,-1.819012,-1.11423,-0.468585,0.443155,1.088799,1.793581,2.146125,2.312736)
  x7OP = c(-1.665021,-1.310924,-0.906937,-0.012715,0.881506,1.285493,1.63959,1.93019,-2.304529,2.279097,-1.955621,-2.073504,-2.248802,2.22337,2.048073,1.469674,0.665594,0.216322,-0.241752,-0.691025,-1.495105)
  y7   = c(0.212883,0.867952,1.447177,2.016781,2.244292,2.244292,2.01678,1.447176,0.867951,0.212881)
  y7OP = c(1.614509,1.90069,2.113342,2.288509,2.113342,1.90069,1.614508,1.265795,0.436267,0.436265,1.265796,1.072094,0.655324,0.655322,1.072092,1.766158,2.189412,2.277419,2.277419,2.189413,1.766159)
  pintarSegmento(x7, y7, x7OP, y7OP, 2.009147)
  
  # Z = 2.511432
  x8   = c(-2.20048,-2.043886,-1.71252,-1.050067,-0.443199,0.413782,1.02065,1.683102,2.014464,2.171061)
  x8OP = c(-1.234947,-0.855224,-0.014708,0.825806,1.20553,1.53836,1.811505,-2.168865,2.139444,-1.840924,-1.567778,-1.951725,-2.116488,2.087066,1.922305,1.378649,0.622862,0.200573,-0.22999,-0.652279,-1.408067)
  y8   = c(0.202653,0.828012,1.380968,1.924739,2.141933,2.141932,1.924739,1.380965,0.828009,0.202651)
  y8OP = c(1.813914,2.016922,2.184144,2.016921,1.813913,1.54071,1.20781,0.415905,0.415903,1.207813,1.540712,1.022895,0.625026,0.625024,1.022892,1.685482,2.089541,2.173557,2.173557,2.089542,1.685483)
  pintarSegmento(x8, y8, x8OP, y8OP, 2.511432)
  
  # Z = 3.013716
  x9   = c(-1.885753,-1.751908,-1.468581,-0.902087,-0.383125,0.349721,0.868683,1.435174,1.718475,1.852337)
  x9OP = c(-1.344806,-1.060187,-0.735467,-0.016702,0.702063,1.026783,1.311401,1.544967,-1.858735,1.825308,-1.57838,-1.673118,-1.813969,1.780535,1.639694,1.174825,0.528515,0.167395,-0.200799,-0.561919,-1.208229)
  y9   = c(0.173536,0.714341,1.192546,1.662806,1.850635,1.850635,1.662805,1.192533,0.714331,0.173535)
  y9OP = c(1.330695,1.566963,1.742525,1.887139,1.742524,1.566961,1.330686,1.042784,0.357952,0.35795,1.042798,0.882877,0.538799,0.538793,0.882865,1.45589,1.805327,1.877984,1.877984,1.805327,1.455896)
  pintarSegmento(x9, y9, x9OP, y9OP, 3.013716)
  
  # Z = 3.495073
  x10   = c(-1.490405,-1.385157,-1.162107,-0.715939,-0.307206,0.269982,0.678715,1.124874,1.347847,1.453149)
  x10OP = c(-1.064624,-0.840459,-0.58471,-0.018612,0.547485,0.803234,1.027398,1.211321,-1.469173,1.43188,-1.248571,-0.957057,-0.448024,-0.163607,0.126383,0.4108,0.919832,1.28587,1.396661,-1.433975,-1.323152)
  y10   = c(0.134151,0.560594,0.93771,1.308552,1.456668,1.456668,1.308551,0.937674,0.560568,0.134151)
  y10OP = c(1.046657,1.232974,1.371416,1.485454,1.371416,1.232969,1.046631,0.819576,0.279565,0.27956,0.819616,1.145389,1.42094,1.478234,1.478234,1.420939,1.145374,0.693465,0.422154,0.422168,0.6935)
  pintarSegmento(x10, y10, x10OP, y10OP, 3.495073)
  
  # Z = 3.850857
  x11   = c(-1.165408,-1.083678,-0.910166,-0.562853,-0.244678,0.20463,0.522804,0.870104,1.043488,1.125307)
  x11OP = c(-1.148935,-0.977457,-0.834284,-0.659784,-0.460698,-0.020024,0.42065,0.619735,0.794232,0.937365,1.108774,-1.121607,-1.035473,-0.750549,-0.354296,-0.132894,0.092846,0.314248,0.7105,0.995329,1.081411)
  y11   = c(0.100802,0.430408,0.721933,1.008598,1.123087,1.123087,1.008596,0.721874,0.430367,0.100801)
  y11OP = c(0.213188,0.630639,0.806154,0.950177,1.05719,1.145338,1.05719,0.95017,0.806111,0.630574,0.213183,0.323409,0.533147,0.882475,1.09547,1.139757,1.139757,1.09547,0.882452,0.533088,0.323388)
  pintarSegmento(x11, y11, x11OP, y11OP, 3.850857)
  
  # Z = 4.017666
  x12   = c(-1.018268,-0.947126,-0.795936,-0.493184,-0.21583,0.175831,0.453185,0.755921,0.906963,0.978204)
  x12OP = c(0.537679,0.689787,0.814536,-1.003939,0.963804,-0.854585,-0.72979,-0.577679,-0.404136,-0.019999,0.364136,0.616799,0.865027,0.93998,-0.980153,-0.905136,-0.656798,-0.311385,-0.118388,0.078389,0.271386)
  y12   = c(0.085713,0.371506,0.624301,0.872878,0.972152,0.972152,0.872876,0.624233,0.371458,0.085713)
  y12OP = c(0.822212,0.697285,0.545059,0.183157,0.18315,0.545135,0.697334,0.822221,0.915012,0.991446,0.915012,0.763488,0.460527,0.278702,0.278727,0.460594,0.763515,0.948205,0.986607,0.986607,0.948205)
  pintarSegmento(x12, y12, x12OP, y12OP, 4.017666)
  
  # Z = 4.18077
  x13   = c(-0.863061,-0.724881,-0.52544,-0.282105,-0.01584,0.250424,0.49376,0.693187,0.831225,0.896339)
  x13OP = c(-0.778476,-0.664438,-0.366859,-0.194788,0.163107,0.335178,0.632754,0.746751,0.883178,-0.824676,-0.597739,-0.44823,-0.105747,0.074066,0.416549,0.566058,0.792896,0.861403)
  y13   = c(0.337962,0.568681,0.749317,0.8643,0.903765,0.8643,0.749309,0.568622,0.337921,0.077123)
  y13OP = c(0.496429,0.635336,0.834006,0.886156,0.886156,0.834006,0.635293,0.496363,0.166054,0.419271,0.695737,0.79555,0.899349,0.899349,0.795549,0.695714,0.419212,0.253264)
  pintarSegmento(x13, y13, x13OP, y13OP, 4.18077)
  
  # Z = 4.526049
  x14   = c(-0.783728,-0.728189,-0.608457,-0.371144,-0.156574,0.070309,0.35834,0.541807,0.677782,0.74957)
  x14OP = c(0.28961,0.423828,0.638585,0.710352,-0.77291,-0.65484,-0.556291,-0.436992,-0.302037,-0.005537,0.145241,-0.081415,-0.230316,-0.498924,-0.694898,-0.754309,0.735106,0.593106,0.485195,0.218458)
  y14   = c(0.063038,0.282943,0.477453,0.668799,0.745207,0.756331,0.668809,0.533696,0.351515,0.136692)
  y14OP = c(0.701235,0.629822,0.416565,0.282969,0.138021,0.416532,0.533664,0.629804,0.701231,0.760055,0.745207,0.756331,0.726778,0.58461,0.351485,0.211558,0.211298,0.477487,0.584636,0.726779)
  pintarSegmento(x14, y14, x14OP, y14OP, 4.526049)
  
  # Z = 4.993195
  x15   = c(-0.741081,-0.687887,-0.559785,-0.321557,-0.125973,0.075619,0.324534,0.494756,0.621215,0.671896)
  x15OP = c(0.140714,0.263018,0.385075,0.584745,0.651526,-0.733056,-0.609162,-0.505206,-0.384979,-0.257033,0.008405,0.662683,-0.059067,-0.191897,-0.446553,-0.652222,-0.715126,0.54245,0.442125,0.202441)
  y15   = c(0.054515,0.249605,0.42227,0.592678,0.660637,0.67052,0.592765,0.472744,0.310905,0.185684)
  y15OP = c(0.660638,0.621572,0.558131,0.368697,0.250004,0.121049,0.368126,0.472295,0.557949,0.621541,0.673829,0.109714,0.67052,0.644259,0.517677,0.310397,0.186288,0.422816,0.517992,0.644266)
  pintarSegmento(x15, y15, x15OP, y15OP, 4.993195)
  
  # Z = 5.480656
  x16   = c(-0.958731,-0.889933,-0.695878,-0.363742,-0.13027,0.099005,0.366428,0.576137,0.732464,0.816824)
  x16OP = c(0.169722,0.295467,0.440545,0.687386,0.769919,-0.953147,-0.770268,-0.615408,-0.446858,-0.283378,0.022959,0.23248,0.511072,0.6351,0.798804,-0.929749,-0.83588,-0.531526,-0.206146,-0.053896)
  y16   = c(0.063708,0.285384,0.481858,0.676987,0.7546,0.765866,0.677259,0.540495,0.356063,0.147457)
  y16OP = c(0.754604,0.710086,0.637792,0.421924,0.286657,0.139328,0.420102,0.539064,0.637218,0.709989,0.769636,0.735947,0.592055,0.483598,0.215066,0.213459,0.354439,0.591057,0.735924,0.765865)
  pintarSegmento(x16, y16, x16OP, y16OP, 5.480656)
  
  # Z = 5.968112
  x17   = c(-1.338609,-1.243037,-0.947619,-0.464051,-0.156985,0.219602,0.456078,0.817795,0.999565,1.085074)
  x17OP = c(-1.335174,-1.060568,-0.826794,-0.580619,-0.355087,0.037515,0.365167,0.555365,0.738262,0.88831,1.067851,-1.302491,-1.16075,-0.7029,-0.254022,-0.059956,0.133435,0.291452,0.650498,0.949087,1.039263)
  y17   = c(0.084093,0.364833,0.613955,0.862623,0.961321,0.961329,0.863145,0.617299,0.36728,0.084631)
  y17OP = c(0.179879,0.5355,0.686781,0.811942,0.904631,0.980411,0.904817,0.813045,0.68953,0.539001,0.181003,0.273762,0.452269,0.753067,0.937602,0.975624,0.975625,0.937645,0.754984,0.455389,0.275521)
  pintarSegmento(x17, y17, x17OP, y17OP, 5.968112)
  
  return("")
}

pintarEjes()
pintarCuerpo()
